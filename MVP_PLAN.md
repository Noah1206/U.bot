# AI Multiverse Shell - MVP Implementation Plan

## 1. MVP 목표

### 1.1 핵심 가치 증명
> "AI 에이전트들이 상호작용하는 모습을 게임처럼 시각화하고 관찰/개입할 수 있다"

### 1.2 MVP 성공 기준
- [ ] 3개 에이전트가 데이터 주고받는 루프 동작
- [ ] 유저가 실시간으로 상호작용 관찰 가능
- [ ] 유저 피드백이 에이전트에 반영됨
- [ ] 픽셀 UI로 시각화

---

## 2. Phase 1: Core Engine (Week 1-2)

### 2.1 목표
Shared Context Bus + 에이전트 기본 구조

### 2.2 작업 항목

```
□ [P1-01] 프로젝트 구조 설정
   - 디렉토리 구조 생성
   - 의존성 정의
   - 개발 환경 설정

□ [P1-02] Shared Context Bus 구현
   - 메시지 스키마 정의
   - Pub/Sub 시스템 (메모리 기반 우선)
   - 이벤트 디스패처

□ [P1-03] Agent 기본 클래스 구현
   - Agent 인터페이스 정의
   - 상태 머신 구현
   - 메시지 핸들링

□ [P1-04] Planner Agent 구현
   - OpenAI/Claude API 연동
   - 계획 생성 로직
   - 출력 포맷팅

□ [P1-05] Critic Agent 구현
   - 평가 프롬프트 설계
   - 리뷰 로직 구현

□ [P1-06] Researcher Agent 구현
   - 조사 프롬프트 설계
   - 정보 수집 로직
```

### 2.3 산출물
- 동작하는 에이전트 루프 (CLI 환경)
- 기본 테스트 케이스

### 2.4 디렉토리 구조 (Phase 1)

```
desiger/
├── src/
│   ├── core/
│   │   ├── bus/
│   │   │   ├── __init__.py
│   │   │   ├── context_bus.py      # Shared Context Bus
│   │   │   ├── events.py           # 이벤트 타입 정의
│   │   │   └── message.py          # 메시지 스키마
│   │   │
│   │   ├── agents/
│   │   │   ├── __init__.py
│   │   │   ├── base.py             # Agent 기본 클래스
│   │   │   ├── planner.py          # Planner Agent
│   │   │   ├── critic.py           # Critic Agent
│   │   │   └── researcher.py       # Researcher Agent
│   │   │
│   │   └── state/
│   │       ├── __init__.py
│   │       └── manager.py          # 상태 관리
│   │
│   ├── providers/
│   │   ├── __init__.py
│   │   ├── base.py                 # AI Provider 인터페이스
│   │   ├── openai.py               # OpenAI 연동
│   │   └── anthropic.py            # Claude 연동
│   │
│   └── cli/
│       ├── __init__.py
│       └── main.py                 # CLI 진입점
│
├── tests/
│   ├── test_bus.py
│   ├── test_agents.py
│   └── test_integration.py
│
├── docs/
│   ├── ARCHITECTURE.md
│   ├── DATA_FLOW.md
│   └── MVP_PLAN.md
│
├── pyproject.toml
├── requirements.txt
└── README.md
```

---

## 3. Phase 2: Visualization (Week 3-4)

### 3.1 목표
픽셀 UI 기본 프레임워크 + 에이전트 시각화

### 3.2 작업 항목

```
□ [P2-01] 픽셀 렌더러 기반 선택
   - Pygame vs Pyglet vs Web(Phaser) 평가
   - 프레임워크 설정

□ [P2-02] 월드 캔버스 구현
   - 타일맵 시스템
   - 카메라/뷰포트
   - 기본 배경

□ [P2-03] 에이전트 스프라이트 구현
   - 캐릭터 스프라이트 시트
   - 애니메이션 시스템
   - 상태별 애니메이션 매핑

□ [P2-04] 데이터 흐름 시각화
   - 에이전트 간 연결선
   - 데이터 전송 애니메이션
   - 아이콘/파티클 효과

□ [P2-05] 상태 패널 UI
   - HUD 레이아웃
   - 에이전트 상태 표시
   - 컨트롤 버튼
```

### 3.3 산출물
- 움직이는 에이전트 캐릭터
- 데이터 흐름 시각화
- 기본 UI 프레임

### 3.4 스프라이트 명세

```
┌─────────────────────────────────────────────────────────────┐
│                    SPRITE SPECIFICATIONS                     │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  캐릭터 크기: 32x32 픽셀 (2x 스케일 → 64x64 표시)           │
│                                                              │
│  Planner 🟦                                                  │
│  ┌────┐  색상: #4A90D9 (파랑)                               │
│  │    │  특징: 연필/클립보드 아이템                          │
│  │ 🟦 │  상태: idle(2), think(3), act(4), wait(2)           │
│  │    │                                                      │
│  └────┘                                                      │
│                                                              │
│  Critic 🟥                                                   │
│  ┌────┐  색상: #D94A4A (빨강)                               │
│  │    │  특징: 돋보기/체크마크 아이템                        │
│  │ 🟥 │  상태: idle(2), think(3), act(4), wait(2)           │
│  │    │                                                      │
│  └────┘                                                      │
│                                                              │
│  Researcher 🟩                                               │
│  ┌────┐  색상: #4AD94A (초록)                               │
│  │    │  특징: 책/망원경 아이템                              │
│  │ 🟩 │  상태: idle(2), think(3), act(4), wait(2)           │
│  │    │                                                      │
│  └────┘                                                      │
│                                                              │
└─────────────────────────────────────────────────────────────┘
```

---

## 4. Phase 3: User Interaction (Week 5-6)

### 4.1 목표
유저 피드백 시스템 + 명령 인터페이스

### 4.2 작업 항목

```
□ [P3-01] 클릭 인터랙션
   - 에이전트 선택
   - 상세 패널 열기
   - 호버 효과

□ [P3-02] 피드백 입력 UI
   - 텍스트 입력 필드
   - 타겟 에이전트 선택
   - 피드백 전송

□ [P3-03] 명령 시스템
   - 커맨드 입력 바
   - 명령 파싱
   - 실행 및 결과 표시

□ [P3-04] 컨트롤 패널
   - 재생/일시정지
   - 속도 조절
   - 뷰 모드 전환

□ [P3-05] 단축키 시스템
   - 키 바인딩
   - 단축키 안내

□ [P3-06] 에이전트 상세 패널
   - 현재 상태 표시
   - 최근 출력 표시
   - 직접 피드백 입력
```

### 4.3 산출물
- 완전한 유저 인터랙션 루프
- 피드백 → 에이전트 → 결과 흐름

---

## 5. Phase 4: AI Integration (Week 7-8)

### 5.1 목표
실제 AI 프로바이더 연동 + 계정 시스템

### 5.2 작업 항목

```
□ [P4-01] OpenAI 연동 완성
   - GPT-4 / GPT-3.5 선택
   - 스트리밍 응답
   - 에러 핸들링

□ [P4-02] Claude 연동
   - Anthropic SDK 통합
   - 모델 선택 옵션

□ [P4-03] API 키 관리
   - 로컬 저장 (암호화)
   - 유효성 검증

□ [P4-04] 계정 연결 UI
   - 프로바이더 선택 화면
   - API 키 입력
   - 연결 테스트

□ [P4-05] 데모 모드 구현
   - 하드코딩된 응답
   - 자동 데모 시나리오
   - 안내 UI

□ [P4-06] 커스텀 에이전트 기초
   - 에이전트 설정 파일
   - 프롬프트 커스터마이징
```

### 5.3 산출물
- 실제 AI 연동 동작
- 데모 모드로 계정 없이 체험 가능

---

## 6. 기술 스택 (확정)

### 6.1 선정 스택

```yaml
language: Python 3.11+
  reason: "AI 멀티 에이전트 Async 관리, LangChain 연계 최적"

backend: FastAPI
  reason: "Python 기반 AI 서버/데이터 처리 연동, 비동기 지원"
  features:
    - WebSocket (실시간 통신)
    - Pydantic (데이터 검증)
    - async/await (비동기 처리)

frontend: Phaser.js
  reason: "브라우저 픽셀 게임형 UI, AI 캐릭터 및 데이터 흐름 시각화"
  features:
    - 픽셀 아트 렌더링
    - 스프라이트 애니메이션
    - 타일맵 시스템

data: Redis
  reason: "Shared Context Bus + Pub/Sub, AI 간 실시간 데이터 교환"
  features:
    - Pub/Sub (이벤트 브로드캐스트)
    - Key-Value (상태 저장)
    - Streams (메시지 히스토리)

ai_sdk: LangChain
  reason: "Python 친화적, 멀티 에이전트 컨텍스트 관리 및 데이터 흐름 제어"
  features:
    - Agent 추상화
    - Memory/Context 관리
    - 다중 LLM 지원 (OpenAI, Claude)
```

### 6.2 아키텍처 다이어그램

```
┌─────────────────────────────────────────────────────────────┐
│                    FRONTEND (Browser)                        │
│  ┌───────────────────────────────────────────────────────┐  │
│  │                   Phaser.js                            │  │
│  │  ┌─────────┐  ┌─────────┐  ┌─────────────────────┐   │  │
│  │  │ Pixel   │  │ Sprite  │  │ WebSocket Client    │   │  │
│  │  │ Canvas  │  │ System  │  │ (real-time events)  │   │  │
│  │  └─────────┘  └─────────┘  └─────────────────────┘   │  │
│  └───────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
                              │
                              │ WebSocket / REST
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    BACKEND (Python)                          │
│  ┌───────────────────────────────────────────────────────┐  │
│  │                   FastAPI                              │  │
│  │  ┌─────────┐  ┌─────────┐  ┌─────────────────────┐   │  │
│  │  │ REST    │  │WebSocket│  │ Background Tasks    │   │  │
│  │  │ Routes  │  │ Handler │  │ (Agent Loop)        │   │  │
│  │  └─────────┘  └─────────┘  └─────────────────────┘   │  │
│  └───────────────────────────────────────────────────────┘  │
│                              │                               │
│  ┌───────────────────────────────────────────────────────┐  │
│  │                   LangChain                            │  │
│  │  ┌─────────┐  ┌─────────┐  ┌─────────────────────┐   │  │
│  │  │ Planner │  │ Critic  │  │ Researcher          │   │  │
│  │  │ Agent   │  │ Agent   │  │ Agent               │   │  │
│  │  └─────────┘  └─────────┘  └─────────────────────┘   │  │
│  └───────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
                              │
                              │ Pub/Sub + State
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                         REDIS                                │
│  ┌─────────────┐  ┌─────────────┐  ┌───────────────────┐   │
│  │ Pub/Sub     │  │ Key-Value   │  │ Streams           │   │
│  │ (events)    │  │ (state)     │  │ (history)         │   │
│  └─────────────┘  └─────────────┘  └───────────────────┘   │
└─────────────────────────────────────────────────────────────┘
```

### 6.3 통신 흐름

```
Frontend (Phaser.js)
    │
    ├── WebSocket ──► /ws/room/{room_id}
    │                 - 실시간 에이전트 상태
    │                 - 메시지 스트림
    │                 - 시각화 이벤트
    │
    └── REST API ──► /api/v1/...
                     - 명령 전송
                     - 피드백 제출
                     - 설정 관리
```

---

## 7. 리스크 및 대응

### 7.1 기술 리스크

| 리스크 | 영향 | 대응 |
|--------|-----|------|
| AI API 비용 | 높음 | 데모 모드, 캐싱, 저비용 모델 |
| 실시간 동기화 | 중간 | 폴링 fallback, 배치 처리 |
| UI 복잡도 | 중간 | Phase 단계적 구현 |
| 에이전트 루프 무한 | 높음 | 턴 제한, 타임아웃 |

### 7.2 범위 리스크

| 리스크 | 대응 |
|--------|-----|
| 기능 과다 | MVP 범위 엄격 준수 |
| 완벽주의 | "동작하는" 우선 |
| UI 과설계 | 기능 우선, 디자인 후순위 |

---

## 8. 마일스톤

```
Week 1-2: Core Engine ──────────────────────────────────► ✅ CLI 동작
Week 3-4: Visualization ────────────────────────────────► ✅ 픽셀 UI
Week 5-6: User Interaction ─────────────────────────────► ✅ 피드백 루프
Week 7-8: AI Integration ───────────────────────────────► ✅ 실제 AI 연동
```

### 성공 데모 시나리오

```
1. 유저가 앱 실행
2. 데모 AI 방 표시 (3개 에이전트 활동 중)
3. 유저가 "웹사이트 기획" 명령 입력
4. Planner가 계획 생성 (시각적 애니메이션)
5. Critic이 검토 (데이터 흐름 시각화)
6. 유저가 Planner 클릭 → 상세 패널
7. "B2B로 좁혀줘" 피드백 입력
8. Planner가 계획 수정
9. 완료된 계획 표시
```

---

## 9. 다음 단계

### 즉시 결정 필요:
1. **기술 스택 확정** - Python Full vs Hybrid
2. **UI 방식 확정** - Native (Pygame) vs Web (Phaser)
3. **Phase 1 착수**

### 선택지:
- [ ] **A**: Python + Pygame으로 바로 시작 (가장 빠른 MVP)
- [ ] **B**: Python + Web(Phaser)로 시작 (배포 용이)
- [ ] **C**: 간단한 TUI로 프로토타입 후 UI 결정

---

*Document Version: 0.1.0*
*Last Updated: 2024*
